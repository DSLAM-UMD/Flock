// Begin DataFusion GraphViz Plan (see https://graphviz.org)
digraph {
  subgraph cluster_1
  {
    graph[label="LogicalPlan"]
    2[shape=box label="Projection: #R.seller, #AVG(R.price)"]
    3[shape=box label="Aggregate: groupBy=[[#R.seller]], aggr=[[AVG(#R.price)]]"]
    2 -> 3 [arrowhead=none, arrowtail=normal, dir=back]
    4[shape=box label="Projection: #R.seller, #R.price, #R.time_rank, alias=R"]
    3 -> 4 [arrowhead=none, arrowtail=normal, dir=back]
    5[shape=box label="Projection: #Q.seller, #Q.price, #ROW_NUMBER() PARTITION BY [#Q.seller] ORDER BY [#Q.b_date_time DESC NULLS FIRST] AS time_rank, alias=R"]
    4 -> 5 [arrowhead=none, arrowtail=normal, dir=back]
    6[shape=box label="Filter: #ROW_NUMBER() PARTITION BY [#Q.seller] ORDER BY [#Q.b_date_time DESC NULLS FIRST] <= Int64(10)"]
    5 -> 6 [arrowhead=none, arrowtail=normal, dir=back]
    7[shape=box label="WindowAggr: windowExpr=[[ROW_NUMBER() PARTITION BY [#Q.seller] ORDER BY [#Q.b_date_time DESC NULLS FIRST]]]"]
    6 -> 7 [arrowhead=none, arrowtail=normal, dir=back]
    8[shape=box label="Projection: #Q.seller, #Q.price, #Q.b_date_time, #Q.price_rank, alias=Q"]
    7 -> 8 [arrowhead=none, arrowtail=normal, dir=back]
    9[shape=box label="Sort: #Q.a_id ASC NULLS LAST, #Q.price DESC NULLS FIRST"]
    8 -> 9 [arrowhead=none, arrowtail=normal, dir=back]
    10[shape=box label="Projection: #auction.seller, #auction.a_id, #bid.price, #bid.b_date_time, #ROW_NUMBER() PARTITION BY [#auction.a_id] ORDER BY [#bid.price DESC NULLS FIRST] AS price_rank, alias=Q"]
    9 -> 10 [arrowhead=none, arrowtail=normal, dir=back]
    11[shape=box label="Filter: #ROW_NUMBER() PARTITION BY [#auction.a_id] ORDER BY [#bid.price DESC NULLS FIRST] = Int64(1)"]
    10 -> 11 [arrowhead=none, arrowtail=normal, dir=back]
    12[shape=box label="WindowAggr: windowExpr=[[ROW_NUMBER() PARTITION BY [#auction.a_id] ORDER BY [#bid.price DESC NULLS FIRST]]]"]
    11 -> 12 [arrowhead=none, arrowtail=normal, dir=back]
    13[shape=box label="Filter: #bid.b_date_time BETWEEN #auction.a_date_time AND #auction.expires"]
    12 -> 13 [arrowhead=none, arrowtail=normal, dir=back]
    14[shape=box label="Join: #auction.a_id = #bid.auction"]
    13 -> 14 [arrowhead=none, arrowtail=normal, dir=back]
    15[shape=box label="TableScan: auction projection=Some([0, 5, 6, 7])"]
    14 -> 15 [arrowhead=none, arrowtail=normal, dir=back]
    16[shape=box label="TableScan: bid projection=Some([0, 2, 3])"]
    14 -> 16 [arrowhead=none, arrowtail=normal, dir=back]
  }
  subgraph cluster_17
  {
    graph[label="Detailed LogicalPlan"]
    18[shape=box label="Projection: #R.seller, #AVG(R.price)\nSchema: [seller:Int32, AVG(R.price):Float64;N]"]
    19[shape=box label="Aggregate: groupBy=[[#R.seller]], aggr=[[AVG(#R.price)]]\nSchema: [seller:Int32, AVG(R.price):Float64;N]"]
    18 -> 19 [arrowhead=none, arrowtail=normal, dir=back]
    20[shape=box label="Projection: #R.seller, #R.price, #R.time_rank, alias=R\nSchema: [seller:Int32, price:Int32, time_rank:UInt64;N]"]
    19 -> 20 [arrowhead=none, arrowtail=normal, dir=back]
    21[shape=box label="Projection: #Q.seller, #Q.price, #ROW_NUMBER() PARTITION BY [#Q.seller] ORDER BY [#Q.b_date_time DESC NULLS FIRST] AS time_rank, alias=R\nSchema: [seller:Int32, price:Int32, time_rank:UInt64;N]"]
    20 -> 21 [arrowhead=none, arrowtail=normal, dir=back]
    22[shape=box label="Filter: #ROW_NUMBER() PARTITION BY [#Q.seller] ORDER BY [#Q.b_date_time DESC NULLS FIRST] <= Int64(10)\nSchema: [ROW_NUMBER() PARTITION BY [#Q.seller] ORDER BY [#Q.b_date_time DESC NULLS FIRST]:UInt64;N, seller:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None), price_rank:UInt64;N]"]
    21 -> 22 [arrowhead=none, arrowtail=normal, dir=back]
    23[shape=box label="WindowAggr: windowExpr=[[ROW_NUMBER() PARTITION BY [#Q.seller] ORDER BY [#Q.b_date_time DESC NULLS FIRST]]]\nSchema: [ROW_NUMBER() PARTITION BY [#Q.seller] ORDER BY [#Q.b_date_time DESC NULLS FIRST]:UInt64;N, seller:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None), price_rank:UInt64;N]"]
    22 -> 23 [arrowhead=none, arrowtail=normal, dir=back]
    24[shape=box label="Projection: #Q.seller, #Q.price, #Q.b_date_time, #Q.price_rank, alias=Q\nSchema: [seller:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None), price_rank:UInt64;N]"]
    23 -> 24 [arrowhead=none, arrowtail=normal, dir=back]
    25[shape=box label="Sort: #Q.a_id ASC NULLS LAST, #Q.price DESC NULLS FIRST\nSchema: [seller:Int32, a_id:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None), price_rank:UInt64;N]"]
    24 -> 25 [arrowhead=none, arrowtail=normal, dir=back]
    26[shape=box label="Projection: #auction.seller, #auction.a_id, #bid.price, #bid.b_date_time, #ROW_NUMBER() PARTITION BY [#auction.a_id] ORDER BY [#bid.price DESC NULLS FIRST] AS price_rank, alias=Q\nSchema: [seller:Int32, a_id:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None), price_rank:UInt64;N]"]
    25 -> 26 [arrowhead=none, arrowtail=normal, dir=back]
    27[shape=box label="Filter: #ROW_NUMBER() PARTITION BY [#auction.a_id] ORDER BY [#bid.price DESC NULLS FIRST] = Int64(1)\nSchema: [ROW_NUMBER() PARTITION BY [#auction.a_id] ORDER BY [#bid.price DESC NULLS FIRST]:UInt64;N, a_id:Int32, a_date_time:Timestamp(Millisecond, None), expires:Timestamp(Millisecond, None), seller:Int32, auction:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None)]"]
    26 -> 27 [arrowhead=none, arrowtail=normal, dir=back]
    28[shape=box label="WindowAggr: windowExpr=[[ROW_NUMBER() PARTITION BY [#auction.a_id] ORDER BY [#bid.price DESC NULLS FIRST]]]\nSchema: [ROW_NUMBER() PARTITION BY [#auction.a_id] ORDER BY [#bid.price DESC NULLS FIRST]:UInt64;N, a_id:Int32, a_date_time:Timestamp(Millisecond, None), expires:Timestamp(Millisecond, None), seller:Int32, auction:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None)]"]
    27 -> 28 [arrowhead=none, arrowtail=normal, dir=back]
    29[shape=box label="Filter: #bid.b_date_time BETWEEN #auction.a_date_time AND #auction.expires\nSchema: [a_id:Int32, a_date_time:Timestamp(Millisecond, None), expires:Timestamp(Millisecond, None), seller:Int32, auction:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None)]"]
    28 -> 29 [arrowhead=none, arrowtail=normal, dir=back]
    30[shape=box label="Join: #auction.a_id = #bid.auction\nSchema: [a_id:Int32, a_date_time:Timestamp(Millisecond, None), expires:Timestamp(Millisecond, None), seller:Int32, auction:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None)]"]
    29 -> 30 [arrowhead=none, arrowtail=normal, dir=back]
    31[shape=box label="TableScan: auction projection=Some([0, 5, 6, 7])\nSchema: [a_id:Int32, a_date_time:Timestamp(Millisecond, None), expires:Timestamp(Millisecond, None), seller:Int32]"]
    30 -> 31 [arrowhead=none, arrowtail=normal, dir=back]
    32[shape=box label="TableScan: bid projection=Some([0, 2, 3])\nSchema: [auction:Int32, price:Int32, b_date_time:Timestamp(Millisecond, None)]"]
    30 -> 32 [arrowhead=none, arrowtail=normal, dir=back]
  }
}
// End DataFusion GraphViz Plan
